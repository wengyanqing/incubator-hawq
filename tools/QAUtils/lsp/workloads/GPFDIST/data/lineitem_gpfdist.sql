DROP TABLE IF EXISTS lineitem_TABLESUFFIX_gpfdist_NUMBER CASCADE;
DROP EXTERNAL TABLE IF EXISTS e_lineitem_TABLESUFFIX_gpfdist_NUMBER;

CREATE TABLE lineitem_TABLESUFFIX_gpfdist_NUMBER ( 
    L_ORDERKEY INTEGER ,
    L_PARTKEY INTEGER ,
    L_SUPPKEY INTEGER ,
    L_LINENUMBER INTEGER ,
    L_QUANTITY DECIMAL(15,2) ,
    L_EXTENDEDPRICE DECIMAL(15,2) ,
    L_DISCOUNT DECIMAL(15,2) ,
    L_TAX DECIMAL(15,2) ,
    L_RETURNFLAG CHAR(1) ,
    L_LINESTATUS CHAR(1) ,
    L_SHIPDATE DATE ,
    L_COMMITDATE DATE ,
    L_RECEIPTDATE DATE ,
    L_SHIPINSTRUCT CHAR(25) ,
    L_SHIPMODE CHAR(10) ,
    L_COMMENT VARCHAR(44) 
) WITH (SQLSUFFIX)
DISTRIBUTED BY(L_ORDERKEY) PARTITIONS;

CREATE EXTERNAL TABLE e_lineitem_TABLESUFFIX_gpfdist_NUMBER ( 
    L_ORDERKEY INTEGER ,
    L_PARTKEY INTEGER ,
    L_SUPPKEY INTEGER ,
    L_LINENUMBER INTEGER ,
    L_QUANTITY DECIMAL(15,2) ,
    L_EXTENDEDPRICE DECIMAL(15,2) ,
    L_DISCOUNT DECIMAL(15,2) ,
    L_TAX DECIMAL(15,2) ,
    L_RETURNFLAG CHAR(1) ,
    L_LINESTATUS CHAR(1) ,
    L_SHIPDATE DATE ,
    L_COMMITDATE DATE ,
    L_RECEIPTDATE DATE ,
    L_SHIPINSTRUCT CHAR(25) ,
    L_SHIPMODE CHAR(10) ,
    L_COMMENT VARCHAR(44) 
)  
LOCATION ('gpfdist://HOSTNAME:GPFDIST_PORT/gpfdist.lineitem.tbl')
FORMAT 'TEXT' (DELIMITER '|');

INSERT INTO lineitem_TABLESUFFIX_gpfdist_NUMBER SELECT * FROM e_lineitem_TABLESUFFIX_gpfdist_NUMBER;
