--@author guz4
--@description TPC-DS tpcds_query9
--@created 2013-03-06 18:02:02
--@created 2013-03-06 18:02:02
--@tags tpcds orca

-- start query 1 in stream 0 using template query9.tpl
select  case when (select count(*) 
                  from store_sales_TABLESUFFIX 
                  where ss_quantity between 1 and 20) > 0.001*74129
            then (select avg(ss_ext_discount_amt) 
                  from store_sales_TABLESUFFIX 
                  where ss_quantity between 1 and 20) 
            else (select avg(ss_net_paid)
                  from store_sales_TABLESUFFIX
                  where ss_quantity between 1 and 20) end bucket1 ,
       case when (select count(*)
                  from store_sales_TABLESUFFIX
                  where ss_quantity between 21 and 40) > 0.001*122840
            then (select avg(ss_ext_discount_amt)
                  from store_sales_TABLESUFFIX
                  where ss_quantity between 21 and 40) 
            else (select avg(ss_net_paid)
                  from store_sales_TABLESUFFIX
                  where ss_quantity between 21 and 40) end bucket2,
       case when (select count(*)
                  from store_sales_TABLESUFFIX
                  where ss_quantity between 41 and 60) > 0.001*56580
            then (select avg(ss_ext_discount_amt)
                  from store_sales_TABLESUFFIX
                  where ss_quantity between 41 and 60)
            else (select avg(ss_net_paid)
                  from store_sales_TABLESUFFIX
                  where ss_quantity between 41 and 60) end bucket3,
       case when (select count(*)
                  from store_sales_TABLESUFFIX
                  where ss_quantity between 61 and 80) > 0.001*10097
            then (select avg(ss_ext_discount_amt)
                  from store_sales_TABLESUFFIX
                  where ss_quantity between 61 and 80)
            else (select avg(ss_net_paid)
                  from store_sales_TABLESUFFIX
                  where ss_quantity between 61 and 80) end bucket4,
       case when (select count(*)
                  from store_sales_TABLESUFFIX
                  where ss_quantity between 81 and 100) > 0.001*165306
            then (select avg(ss_ext_discount_amt)
                  from store_sales_TABLESUFFIX
                  where ss_quantity between 81 and 100)
            else (select avg(ss_net_paid)
                  from store_sales_TABLESUFFIX
                  where ss_quantity between 81 and 100) end bucket5
from reason_TABLESUFFIX
where r_reason_sk = 1
limit 100;

-- end query 1 in stream 0 using template query9.tpl
